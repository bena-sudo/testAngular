import { Component, OnInit } from '@angular/core';
import * as L from 'leaflet';

@Component({
  selector: 'app-dashboar',
  imports: [],
  templateUrl: './dashboar.component.html',
  styleUrl: './dashboar.component.css',
})
export class DashboarComponent implements OnInit {
  private map!: L.Map;

  private costeraCoords: L.LatLngTuple[] = [
    [38.891864, -0.924473],
    [38.896741, -0.908508],
    [38.900615, -0.901899],
    [38.901751, -0.898981],
    [38.902552, -0.88851],
    [38.910166, -0.861387],
    [38.910768, -0.852461],
    [38.917312, -0.835981],
    [38.916244, -0.826368],
    [38.912504, -0.813236],
    [38.919316, -0.781994],
    [38.917646, -0.77178],
    [38.919583, -0.771265],
    [38.920184, -0.769548],
    [38.916978, -0.766973],
    [38.917045, -0.763626],
    [38.919984, -0.760793],
    [38.924524, -0.738992],
    [38.925192, -0.727491],
    [38.929866, -0.720882],
    [38.939747, -0.710497],
    [38.948959, -0.696335],
    [38.963443, -0.683803],
    [38.965912, -0.677194],
    [38.968048, -0.672474],
    [38.97392, -0.667496],
    [38.981927, -0.652904],
    [38.981059, -0.651102],
    [38.980793, -0.64372],
    [38.985129, -0.644836],
    [38.987998, -0.639772],
    [38.987998, -0.638056],
    [38.988598, -0.63591],
    [38.992201, -0.634622],
    [38.994536, -0.634107],
    [38.997271, -0.632219],
    [39.000806, -0.628786],
    [39.001907, -0.625825],
    [39.005642, -0.629945],
    [39.008176, -0.629172],
    [39.010244, -0.630202],
    [39.013445, -0.629859],
    [39.017446, -0.629258],
    [39.026848, -0.63312],
    [39.029115, -0.631919],
    [39.030449, -0.625911],
    [39.030049, -0.621447],
    [39.027649, -0.616298],
    [39.027315, -0.610719],
    [39.025315, -0.603852],
    [39.01778, -0.59587],
    [39.016579, -0.597501],
    [39.016179, -0.599475],
    [39.013645, -0.59999],
    [39.014445, -0.596213],
    [39.015046, -0.593982],
    [39.014112, -0.590634],
    [39.011911, -0.590377],
    [39.014912, -0.583081],
    [39.014579, -0.581794],
    [39.016046, -0.577159],
    [39.01838, -0.57261],
    [39.018513, -0.570206],
    [39.021981, -0.568061],
    [39.026648, -0.56643],
    [39.027649, -0.566258],
    [39.028982, -0.567717],
    [39.037716, -0.568061],
    [39.040183, -0.567117],
    [39.041583, -0.567546],
    [39.045582, -0.55304],
    [39.047182, -0.550551],
    [39.044516, -0.544715],
    [39.044916, -0.542912],
    [39.046382, -0.541968],
    [39.043049, -0.540423],
    [39.042116, -0.538964],
    [39.040583, -0.538363],
    [39.041183, -0.529094],
    [39.040449, -0.529694],
    [39.039883, -0.525725],
    [39.040483, -0.522721],
    [39.039816, -0.520489],
    [39.042349, -0.518772],
    [39.043149, -0.513708],
    [39.044482, -0.513623],
    [39.045682, -0.509417],
    [39.047416, -0.509589],
    [39.049349, -0.511048],
    [39.045749, -0.505812],
    [39.045016, -0.499632],
    [39.042616, -0.499031],
    [39.042749, -0.497229],
    [39.037683, -0.496371],
    [39.040349, -0.494311],
    [39.038749, -0.492937],
    [39.037616, -0.486414],
    [39.040483, -0.482037],
    [39.038149, -0.480149],
    [39.032616, -0.473025],
    [39.028882, -0.469849],
    [39.026682, -0.460408],
    [39.026882, -0.456974],
    [39.028749, -0.453026],
    [39.028815, -0.45028],
    [39.027949, -0.445816],
    [39.026348, -0.443585],
    [39.028282, -0.437405],
    [39.031282, -0.434916],
    [39.032482, -0.431826],
    [39.032549, -0.428564],
    [39.034016, -0.42084],
    [39.034216, -0.417235],
    [39.037216, -0.416291],
    [39.036683, -0.412772],
    [39.035416, -0.410969],
    [39.035349, -0.407707],
    [39.034016, -0.407622],
    [39.033549, -0.400412],
    [39.033949, -0.397494],
    [39.032883, -0.390713],
    [39.034216, -0.388567],
    [39.037016, -0.388138],
    [39.038483, -0.383246],
    [39.043083, -0.407278],
    [39.040016, -0.40745],
    [39.041216, -0.409167],
    [39.043816, -0.409853],
    [39.048149, -0.414402],
    [39.052015, -0.425646],
    [39.051815, -0.435087],
    [39.071475, -0.431912],
    [39.068178, -0.414363],
    [39.065046, -0.408784],
    [39.056582, -0.391188],
    [39.058448, -0.385609],
    [39.056116, -0.380717],
    [39.053116, -0.378571],
    [39.051717, -0.375481],
    [39.05025, -0.37428],
    [39.046517, -0.374194],
    [39.038384, -0.38312],
    [39.035918, -0.383549],
    [39.033851, -0.385009],
    [39.022049, -0.381404],
    [39.021516, -0.379945],
    [38.99944, -0.395995],
    [38.984297, -0.404063],
    [38.987099, -0.407582],
    [38.986032, -0.418397],
    [38.986832, -0.421143],
    [38.985298, -0.427409],
    [38.982229, -0.429641],
    [38.980227, -0.433675],
    [38.980627, -0.438567],
    [38.978692, -0.442343],
    [38.978426, -0.445863],
    [38.977425, -0.445948],
    [38.976691, -0.448523],
    [38.976691, -0.457192],
    [38.973154, -0.465518],
    [38.971619, -0.466891],
    [38.971486, -0.468779],
    [38.967148, -0.481654],
    [38.967682, -0.483542],
    [38.966615, -0.487319],
    [38.96568, -0.487662],
    [38.96528, -0.491267],
    [38.964279, -0.490237],
    [38.960808, -0.492898],
    [38.959138, -0.499943],
    [38.961875, -0.501488],
    [38.96094, -0.503892],
    [38.959205, -0.507754],
    [38.95747, -0.509642],
    [38.956202, -0.509728],
    [38.953665, -0.518311],
    [38.951196, -0.519599],
    [38.948459, -0.528439],
    [38.950194, -0.530499],
    [38.94679, -0.541056],
    [38.945054, -0.54303],
    [38.945054, -0.545434],
    [38.94185, -0.552558],
    [38.941249, -0.555047],
    [38.937711, -0.560196],
    [38.93731, -0.563029],
    [38.934473, -0.564703],
    [38.933271, -0.569423],
    [38.930467, -0.572427],
    [38.926594, -0.572856],
    [38.923656, -0.576719],
    [38.923923, -0.578092],
    [38.922588, -0.582126],
    [38.920718, -0.584787],
    [38.918514, -0.584444],
    [38.917379, -0.586418],
    [38.917179, -0.588993],
    [38.913906, -0.593542],
    [38.912905, -0.593713],
    [38.910233, -0.600837],
    [38.909231, -0.601181],
    [38.904489, -0.606416],
    [38.903153, -0.609506],
    [38.903421, -0.613884],
    [38.899947, -0.616802],
    [38.89614, -0.61766],
    [38.893802, -0.620578],
    [38.891063, -0.622209],
    [38.880172, -0.637315],
    [38.880507, -0.642208],
    [38.878836, -0.643066],
    [38.879304, -0.647701],
    [38.872355, -0.655426],
    [38.861729, -0.661005],
    [38.858588, -0.671905],
    [38.856783, -0.674051],
    [38.8503, -0.688385],
    [38.850634, -0.691389],
    [38.848695, -0.691045],
    [38.843682, -0.701259],
    [38.836729, -0.721258],
    [38.835726, -0.72821],
    [38.832918, -0.73542],
    [38.830544, -0.738896],
    [38.8268, -0.742673],
    [38.823624, -0.752843],
    [38.824393, -0.755204],
    [38.820849, -0.762499],
    [38.819244, -0.768422],
    [38.804932, -0.807561],
    [38.799982, -0.817259],
    [38.797038, -0.819233],
    [38.788676, -0.832022],
    [38.785733, -0.84009],
    [38.782521, -0.844811],
    [38.781651, -0.848588],
    [38.777202, -0.850476],
    [38.769439, -0.860175],
    [38.770945, -0.861763],
    [38.771982, -0.882534],
    [38.771581, -0.885194],
    [38.769239, -0.887211],
    [38.767231, -0.899099],
    [38.767064, -0.90485],
    [38.76954, -0.913261],
    [38.776198, -0.917553],
    [38.781417, -0.914892],
    [38.783792, -0.928968],
    [38.786836, -0.929011],
    [38.793928, -0.933903],
    [38.811219, -0.93283],
    [38.815766, -0.927723],
    [38.82339, -0.924762],
    [38.829809, -0.931157],
    [38.841676, -0.932273],
    [38.855914, -0.935706],
    [38.863667, -0.93077],
    [38.867877, -0.932573],
    [38.871285, -0.931543],
    [38.879638, -0.931886],
    [38.88495, -0.927466],
    [38.891797, -0.924505],
    [38.896607, -0.908626],
  ];

  ubicaciones = [
    {
      id: 1,
      cantidad: 25,
      ubicacion: 'Parque de la Paz',
      municipio: 'Xàtiva',
      latitud: 38.9896,
      longitud: -0.5183,
    },
    {
      id: 2,
      cantidad: 18,
      ubicacion: 'Avenida Selgas',
      municipio: 'Canals',
      latitud: 38.9625,
      longitud: -0.5866,
    },
    {
      id: 3,
      cantidad: 30,
      ubicacion: 'Zona Industrial',
      municipio: "L'Alcúdia de Crespins",
      latitud: 38.9602,
      longitud: -0.5875,
    },
    {
      id: 4,
      cantidad: 22,
      ubicacion: 'Calle Mayor',
      municipio: 'Moixent',
      latitud: 38.8941,
      longitud: -0.7619,
    },
    {
      id: 5,
      cantidad: 15,
      ubicacion: 'Barrio del Carmen',
      municipio: 'La Llosa de Ranes',
      latitud: 38.9937,
      longitud: -0.5374,
    },
    {
      id: 6,
      cantidad: 27,
      ubicacion: 'Plaza del Mercado',
      municipio: 'Genovés',
      latitud: 38.9874,
      longitud: -0.5078,
    },
    {
      id: 7,
      cantidad: 35,
      ubicacion: 'Parque de la Ermita',
      municipio: 'Montesa',
      latitud: 38.8992,
      longitud: -0.6881,
    },
    {
      id: 8,
      cantidad: 20,
      ubicacion: 'Centro Histórico',
      municipio: 'Rotglà i Corberà',
      latitud: 38.9665,
      longitud: -0.5763,
    },
    {
      id: 9,
      cantidad: 23,
      ubicacion: 'Paseo del Cid',
      municipio: "Llocnou d'En Fenollet",
      latitud: 38.9871,
      longitud: -0.5432,
    },
    {
      id: 10,
      cantidad: 19,
      ubicacion: 'Boulevard Principal',
      municipio: 'Vallada',
      latitud: 38.8894,
      longitud: -0.7701,
    },
  ];

  ngOnInit(): void {
    this.initMap();
    this.addMarkers();
    this.resaltarCostera();
  }

  private initMap(): void {
    this.map = L.map('map').setView([38.925, -0.6719], 12);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap contributors',
    }).addTo(this.map);
  }

  private addMarkers(): void {
    this.ubicaciones.forEach((ubi) => {
      L.marker([ubi.latitud, ubi.longitud])
        .addTo(this.map)
        .bindPopup(`<b>${ubi.municipio}</b><br>${ubi.ubicacion}`);
    });
  }

  private resaltarCostera(): void {
    const poligono = L.polygon(this.costeraCoords, {
      color: 'red',
      fillColor: 'orange',
      fillOpacity: 0.1,
    }).addTo(this.map);

    this.map.fitBounds(poligono.getBounds());
  }
}
